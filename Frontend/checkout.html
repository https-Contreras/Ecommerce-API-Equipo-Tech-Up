<!-- Frontend/checkout.html -->

<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finalizar Compra - Tech-Up</title>
    
    <script>
        (function() {
            const user = localStorage.getItem('userName');
            const userKey = user ? user.replace(/\s+/g, '_') : 'guest';
            const savedTheme = localStorage.getItem(`theme_${userKey}`);
            if (savedTheme === 'light') {
                document.documentElement.classList.add('light-mode');
            }
        })();
    </script>

    <link rel="stylesheet" href="/Frontend/CSS/main.css">
    <link rel="stylesheet" href="/Frontend/CSS/carrito-styles.css">
    <link rel="stylesheet" href="/Frontend/CSS/checkout-styles.css">
    
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>
    <header class="site-header" id="main-header"></header>

    <main class="container">
        <h2>Finalizar Compra</h2>

        <div class="checkout-wrapper">
            
            <!-- Columna 1: M√©todo de Pago -->
            <div class="checkout-form-section">
                
                <!-- Selector de m√©todo de pago -->
                <div class="payment-methods">
                    <h3>Selecciona tu m√©todo de pago</h3>
                    
                    <div class="payment-options">
                        <label class="payment-option active" data-method="tarjeta">
                            <input type="radio" name="payment-method" value="tarjeta" checked>
                            <div class="payment-option-content">
                                <span class="payment-icon">üí≥</span>
                                <span class="payment-name">Tarjeta de Cr√©dito/D√©bito</span>
                            </div>
                        </label>
                        
                        <label class="payment-option" data-method="oxxo">
                            <input type="radio" name="payment-method" value="oxxo">
                            <div class="payment-option-content">
                                <span class="payment-icon">üè™</span>
                                <span class="payment-name">Pago en OXXO</span>
                            </div>
                        </label>
                        
                        <label class="payment-option" data-method="transferencia">
                            <input type="radio" name="payment-method" value="transferencia">
                            <div class="payment-option-content">
                                <span class="payment-icon">üè¶</span>
                                <span class="payment-name">Transferencia Bancaria</span>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Formulario de Tarjeta -->
                <form id="form-tarjeta" class="payment-form active">
                    <h4>üí≥ Datos de tu Tarjeta</h4>
                    
                    <div class="form-group">
                        <input type="text" id="card-name" name="card-name" required 
                               placeholder=" " autocomplete="cc-name">
                        <label for="card-name">Nombre del Titular</label>
                    </div>
                    
                    <div class="form-group">
                        <input type="text" id="card-number" name="card-number" required 
                               placeholder=" " maxlength="19" autocomplete="cc-number"
                               inputmode="numeric">
                        <label for="card-number">N√∫mero de Tarjeta</label>
                        <span class="card-type-icon" id="card-type-icon"></span>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" id="card-expiry" name="card-expiry" required 
                                   placeholder=" " maxlength="5" autocomplete="cc-exp">
                            <label for="card-expiry">MM/AA</label>
                        </div>
                        
                        <div class="form-group">
                            <input type="text" id="card-cvv" name="card-cvv" required 
                                   placeholder=" " maxlength="4" autocomplete="cc-csc"
                                   inputmode="numeric">
                            <label for="card-cvv">CVV</label>
                        </div>
                    </div>
                    
                    <div class="secure-badge">
                        üîí Tus datos est√°n protegidos con encriptaci√≥n SSL
                    </div>
                </form>

                <!-- Formulario de OXXO -->
                <form id="form-oxxo" class="payment-form">
                    <h4>üè™ Pago en OXXO</h4>
                    
                    <div class="oxxo-info">
                        <p>Al confirmar tu pedido, generaremos una <strong>referencia de pago</strong> que podr√°s presentar en cualquier tienda OXXO.</p>
                        
                        <div class="oxxo-steps">
                            <div class="step">
                                <span class="step-number">1</span>
                                <span>Confirma tu pedido</span>
                            </div>
                            <div class="step">
                                <span class="step-number">2</span>
                                <span>Recibe tu referencia por correo</span>
                            </div>
                            <div class="step">
                                <span class="step-number">3</span>
                                <span>Paga en OXXO (tienes 48 hrs)</span>
                            </div>
                            <div class="step">
                                <span class="step-number">4</span>
                                <span>¬°Recibe tu pedido!</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <input type="email" id="oxxo-email" name="oxxo-email" required placeholder=" ">
                            <label for="oxxo-email">Correo para recibir la referencia</label>
                        </div>
                    </div>
                </form>

                <!-- Formulario de Transferencia -->
                <form id="form-transferencia" class="payment-form">
                    <h4>üè¶ Transferencia Bancaria</h4>
                    
                    <div class="transfer-info">
                        <p>Realiza una transferencia a la siguiente cuenta y confirma tu pago:</p>
                        
                        <div class="bank-details">
                            <div class="bank-detail">
                                <span class="detail-label">Banco:</span>
                                <span class="detail-value">BBVA M√©xico</span>
                            </div>
                            <div class="bank-detail">
                                <span class="detail-label">Titular:</span>
                                <span class="detail-value">Tech-Up S.A. de C.V.</span>
                            </div>
                            <div class="bank-detail">
                                <span class="detail-label">CLABE:</span>
                                <span class="detail-value" id="clabe-number">012180001234567890</span>
                                <button type="button" class="copy-btn" onclick="copiarClabe()">üìã Copiar</button>
                            </div>
                            <div class="bank-detail">
                                <span class="detail-label">Cuenta:</span>
                                <span class="detail-value">0123456789</span>
                            </div>
                            <div class="bank-detail">
                                <span class="detail-label">Referencia:</span>
                                <span class="detail-value" id="transfer-reference">Se generar√° al confirmar</span>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <input type="email" id="transfer-email" name="transfer-email" required placeholder=" ">
                            <label for="transfer-email">Correo para confirmar tu pago</label>
                        </div>
                        
                        <p class="transfer-note">‚è∞ Una vez realizada la transferencia, tu pedido ser√° procesado en un m√°ximo de 24 horas h√°biles.</p>
                    </div>
                </form>

                <!-- CAPTCHA -->
                <div class="captcha-section">
                    <div class="g-recaptcha" data-sitekey="6Le84A0sAAAAAFllLkm3fs8hIY90-EZp6yQOfCL0"></div>
                </div>

                <!-- Bot√≥n de pago -->
                <button type="button" id="btn-confirmar-pago" class="submit-btn checkout-btn">
                    üîí Confirmar y Pagar
                </button>
            </div>

            <!-- Columna 2: Resumen del Pedido -->
            <aside class="checkout-summary">
                <h3>Resumen del Pedido</h3>
                
                <div id="checkout-items" class="checkout-items">
                    <!-- Items se cargan din√°micamente -->
                </div>
                
                <div class="summary-divider"></div>
                
                <div class="summary-line">
                    <span>Subtotal:</span>
                    <span id="checkout-subtotal">$0.00</span>
                </div>
                
                <div class="summary-line" id="checkout-discount-line" style="display: none;">
                    <span>Descuento:</span>
                    <span id="checkout-discount">-$0.00</span>
                </div>
                
                <div class="summary-line">
                    <span>Env√≠o:</span>
                    <span id="checkout-shipping">$0.00</span>
                </div>
                
                <div class="summary-line total">
                    <span>Total a Pagar:</span>
                    <span id="checkout-total">$0.00</span>
                </div>
                
                <a href="carrito.html" class="back-to-cart">‚Üê Volver al carrito</a>
            </aside>
        </div>
    </main>

    <footer class="site-footer" id="main-footer"></footer>
    
    <script src="/Frontend/js/footer.js"></script>
    <script src="/Frontend/js/loadComponents.js"></script>
    <script src="/Frontend/js/accesibilidad.js"></script>
    <script src="/Frontend/js/checkout.js"></script>
</body>
</html>